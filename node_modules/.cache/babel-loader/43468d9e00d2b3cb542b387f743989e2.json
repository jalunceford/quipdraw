{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef,useEffect,useState}from'react';import socket from\"../socketConfig\";import firebase from'../firebase.js';import{Redirect}from'react-router-dom';function Vote(props){var _useState=useState(props.location.state.code),_useState2=_slicedToArray(_useState,2),code=_useState2[0],setCode=_useState2[1];var _useState3=useState(props.location.state.name),_useState4=_slicedToArray(_useState3,2),name=_useState4[0],setName=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),pictures=_useState6[0],setPictures=_useState6[1];var _useState7=useState(props.location.state.round),_useState8=_slicedToArray(_useState7,2),round=_useState8[0],setRound=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),resultTime=_useState10[0],setResultTime=_useState10[1];var _useState11=useState(props.location.state.groupSize),_useState12=_slicedToArray(_useState11,2),groupSize=_useState12[0],setGroupSize=_useState12[1];var _useState13=useState(),_useState14=_slicedToArray(_useState13,2),vote=_useState14[0],setVote=_useState14[1];var inputRef=useRef(null);var _useState15=useState(),_useState16=_slicedToArray(_useState15,2),word=_useState16[0],setWord=_useState16[1];var _useState17=useState(20),_useState18=_slicedToArray(_useState17,2),time=_useState18[0],setTime=_useState18[1];useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var numVotes,db,interval;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(code);console.log(round);numVotes=0;socket.on(\"vote\",function(){numVotes++;if(numVotes==groupSize){setResultTime(true);}});db=firebase.firestore();//await getWord();\n// db.collection(\"rooms\").where(\"code\", \"==\", code).get().then((querySnapshot) => {\n//     querySnapshot.docs.forEach((snapshot) => {\n//         snapshot.ref.collection(\"rounds\").where(\"round\", \"==\", round).get().then((querySnapshot) => {\n//             querySnapshot.docs.forEach((snapshot) => {\n//                 snapshot.ref.collection(\"pictures\").get().then((querySnapshot) => {\n//                     querySnapshot.docs.forEach((doc) => {\n//                         setPictures(pictures => pictures.concat(doc.data().dataURL));\n//                     });\n//                 });\n//             });\n//         });\n//     });\n// });\ninterval=setInterval(function(){setTime(function(time){return time-1;});if(time==0){clearInterval(interval);setResultTime(true);}},1000);case 6:case\"end\":return _context.stop();}}},_callee);})),[]);var updateVote=function updateVote(event){setVote({vote:event.target.value});};//   const submitVote = () => {\n//       let votedPicture = pictures[vote];\n//       const db = firebase.firestore();\n//       db.collection(\"rooms\").where(\"code\", \"==\", code).collection(\"rounds\").where(\"round\", \"==\", round).collection(\"pictures\").where(\"dataURL\", \"==\", votedPicture).update({\n//           votes : firebase.firestore.FieldValue.increment(1)\n//       }).then(() => {\n//         db.collection(\"rooms\").where(\"code\", \"==\", code).collection(\"rounds\").where(\"round\", \"==\", round).collection(\"pictures\").where(\"dataURL\", \"==\", votedPicture).get().then((doc) => {\n//             db.collection(\"rooms\").where(\"code\", \"==\", code).collection(\"players\").where(\"name\", \"==\", doc.data().artist).update({\n//                 votes : firebase.firestore.FieldValue.increment(1)\n//             }).then(() => {\n//                 socket.emit(\"vote\", code);\n//             });\n//         });\n//     });\n// }\nvar getWord=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var db;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:db=firebase.firestore();db.collection(\"rooms\").where(\"code\",\"==\",code).get().then(function(querySnapshot){querySnapshot.docs.forEach(function(snapshot){snapshot.ref.collection(\"rounds\").where(\"round\",\"==\",round).get().then(function(querySnapshot){querySnapshot.docs.forEach(function(snapshot){setWord(snapshot.data().word);});});});});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function getWord(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h1\",null,time),/*#__PURE__*/React.createElement(\"h1\",null,word),pictures.map(function(idx,picture){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"img\",{src:picture,id:picture}),/*#__PURE__*/React.createElement(\"label\",{htmlFor:picture},idx));}),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",id:\"vote\",onChange:updateVote,ref:inputRef}),/*#__PURE__*/React.createElement(\"button\",{id:\"done\"},\"Done1\"),resultTime?/*#__PURE__*/React.createElement(Redirect,{to:{pathname:'/result',state:{code:code,name:name,groupSize:groupSize,round:round}}}):null);}export default Vote;","map":{"version":3,"sources":["/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/src/pages/vote.jsx"],"names":["React","useRef","useEffect","useState","socket","firebase","Redirect","Vote","props","location","state","code","setCode","name","setName","pictures","setPictures","round","setRound","resultTime","setResultTime","groupSize","setGroupSize","vote","setVote","inputRef","word","setWord","time","setTime","console","log","numVotes","on","db","firestore","interval","setInterval","clearInterval","updateVote","event","target","value","getWord","collection","where","get","then","querySnapshot","docs","forEach","snapshot","ref","data","map","idx","picture","pathname"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\nimport socket from \"../socketConfig\";\nimport firebase from '../firebase.js';\nimport { Redirect } from 'react-router-dom';\n\nfunction Vote(props) {\n\n  const [code, setCode] = useState(props.location.state.code);\n  const [name, setName] = useState(props.location.state.name);\n  const [pictures, setPictures] = useState([]);\n  const [round, setRound] = useState(props.location.state.round);\n  const [resultTime, setResultTime] = useState(false);\n  const [groupSize, setGroupSize] = useState(props.location.state.groupSize);\n  const [vote, setVote] = useState();\n  const inputRef = useRef(null);\n  const [word, setWord] = useState();\n  const [time, setTime] = useState(20);\n\n  useEffect(async() => {\n    console.log(code);\n    console.log(round);\n    let numVotes = 0;\n    socket.on(\"vote\", () => {\n        numVotes ++;\n        if (numVotes == groupSize) {\n            setResultTime(true);\n        }\n    });\n    const db = firebase.firestore();\n    \n    //await getWord();\n    // db.collection(\"rooms\").where(\"code\", \"==\", code).get().then((querySnapshot) => {\n    //     querySnapshot.docs.forEach((snapshot) => {\n    //         snapshot.ref.collection(\"rounds\").where(\"round\", \"==\", round).get().then((querySnapshot) => {\n    //             querySnapshot.docs.forEach((snapshot) => {\n    //                 snapshot.ref.collection(\"pictures\").get().then((querySnapshot) => {\n    //                     querySnapshot.docs.forEach((doc) => {\n    //                         setPictures(pictures => pictures.concat(doc.data().dataURL));\n    //                     });\n    //                 });\n    //             });\n    //         });\n    //     });\n    // });\n    \n    const interval = setInterval(() => {\n        setTime( time => time - 1);\n        if (time == 0) {\n            clearInterval(interval);\n            setResultTime(true);\n        }\n    }, 1000);\n}, []);\n\n  const updateVote = (event) => {\n      setVote({vote: event.target.value});\n  }\n\n//   const submitVote = () => {\n//       let votedPicture = pictures[vote];\n//       const db = firebase.firestore();\n//       db.collection(\"rooms\").where(\"code\", \"==\", code).collection(\"rounds\").where(\"round\", \"==\", round).collection(\"pictures\").where(\"dataURL\", \"==\", votedPicture).update({\n//           votes : firebase.firestore.FieldValue.increment(1)\n//       }).then(() => {\n//         db.collection(\"rooms\").where(\"code\", \"==\", code).collection(\"rounds\").where(\"round\", \"==\", round).collection(\"pictures\").where(\"dataURL\", \"==\", votedPicture).get().then((doc) => {\n//             db.collection(\"rooms\").where(\"code\", \"==\", code).collection(\"players\").where(\"name\", \"==\", doc.data().artist).update({\n//                 votes : firebase.firestore.FieldValue.increment(1)\n//             }).then(() => {\n//                 socket.emit(\"vote\", code);\n//             });\n//         });\n//     });\n// }\n\nconst getWord = async () => {\n    const db = firebase.firestore();\n    db.collection(\"rooms\").where(\"code\", \"==\", code).get().then((querySnapshot) => {\n      querySnapshot.docs.forEach((snapshot) => {\n        snapshot.ref.collection(\"rounds\").where(\"round\", \"==\", round).get().then((querySnapshot) => {\n          querySnapshot.docs.forEach((snapshot) => {\n              setWord(snapshot.data().word);\n          });\n      });\n  });\n});\n}\n\n  return (\n    <div>\n        <h1>{time}</h1>\n        <h1>{word}</h1>\n        {pictures.map((idx, picture) => {\n            return (<div>\n                        <img src={picture} id={picture}/>\n                        <label htmlFor={picture}>{idx}</label>\n                    </div>)\n                        })}\n        <input type=\"text\" id=\"vote\" onChange={updateVote} ref={inputRef}/>\n        <button id=\"done\">Done1</button>\n        {resultTime ? <Redirect to={{pathname: '/result', state: {code: code, name: name, groupSize: groupSize, round: round}}}/> : null }\n    </div>\n    );\n}\n\nexport default Vote;"]},"metadata":{},"sourceType":"module"}