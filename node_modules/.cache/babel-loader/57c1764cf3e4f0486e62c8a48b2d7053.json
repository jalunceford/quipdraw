{"ast":null,"code":"import _toConsumableArray from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{Redirect}from'react-router-dom';import socket from\"../socketConfig\";import firebase from'../firebase.js';var Room=/*#__PURE__*/function(_React$Component){_inherits(Room,_React$Component);var _super=_createSuper(Room);function Room(props){var _this;_classCallCheck(this,Room);_this=_super.call(this,props);_this.state={code:_this.props.location.state.code,name:_this.props.location.state.name,players:[],hasCreatedGame:false,groupSize:0,hasReceivedGroupSize:false};return _this;}_createClass(Room,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var db=firebase.firestore();db.collection(\"rooms\").where(\"code\",\"==\",this.state.code).collection(\"players\").onSnapshot(function(querySnapshot){querySnapshot.forEach(function(doc){_this2.setState(function(prevState){return{players:[].concat(_toConsumableArray(prevState.players),[doc.data().name])};});});});socket.on(\"gameCreated\",function(words){var docRef=db.collection(\"rooms\").where(\"code\",\"==\",_this2.state.code);docRef.update({words:words}).then(function(){var docsArray=[];for(var i=0;i<words.length;i++){docsArray.push({round:i+1,words:words[i]});}var batch=db.batch();docsArray.forEach(function(doc){docRef=docRef.collection(\"rounds\").doc();batch.set(docRef,doc);});batch.commit().then(function(){_this2.setState({hasCreatedGame:true});socket.emit(\"getGroupSize\",_this2.state.code);});});});socket.on(\"groupSize\",function(size){_this2.setState({groupSize:size});_this2.setState({hasReceivedGroupSize:true});});}},{key:\"createGame\",value:function createGame(){socket.emit(\"createGame\",this.state.code);}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"label\",{for:\"playersList\",id:\"label\"},\"Players who have joined the room:\"),/*#__PURE__*/React.createElement(\"ul\",{id:\"playersList\"},this.state.players.map(function(idx,player){return/*#__PURE__*/React.createElement(\"li\",{key:idx},player);})),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",id:\"play\",onClick:this.createGame},\"Play\"),this.state.hasCreatedGame&&this.state.hasReceivedGroupSize?/*#__PURE__*/React.createElement(Redirect,{to:{pathname:'/game',state:{code:this.state.code,name:this.state.name,groupSize:this.state.groupSize,round:1}}}):null,\"}\");}}]);return Room;}(React.Component);export default Room;","map":{"version":3,"sources":["/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/src/pages/room.jsx"],"names":["React","Redirect","socket","firebase","Room","props","state","code","location","name","players","hasCreatedGame","groupSize","hasReceivedGroupSize","db","firestore","collection","where","onSnapshot","querySnapshot","forEach","doc","setState","prevState","data","on","words","docRef","update","then","docsArray","i","length","push","round","batch","set","commit","emit","size","map","idx","player","createGame","pathname","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { Redirect } from 'react-router-dom'\nimport socket from \"../socketConfig\";\nimport firebase from '../firebase.js';\n\nclass Room extends React.Component {\n\n        constructor(props) {\n          super(props);\n          this.state = {\n            code: this.props.location.state.code,\n            name: this.props.location.state.name,\n            players: [],\n            hasCreatedGame: false,\n            groupSize: 0,\n            hasReceivedGroupSize: false,\n          };\n        }\n      \n        componentDidMount() {\n          const db = firebase.firestore();\n          db.collection(\"rooms\").where(\"code\", \"==\", this.state.code).collection(\"players\")\n          .onSnapshot((querySnapshot) => {\n            querySnapshot.forEach((doc) => {\n              this.setState(prevState => ({\n                players: [...prevState.players, doc.data().name]\n              }));\n            });\n          });\n          socket.on(\"gameCreated\", (words) => {\n            let docRef = db.collection(\"rooms\").where(\"code\", \"==\", this.state.code);\n            docRef.update({words: words}).then(() => {\n              const docsArray = [];\n              for (let i = 0; i < words.length; i ++) {\n                docsArray.push({round: i + 1, words: words[i]});\n              }\n              const batch = db.batch();\n              docsArray.forEach((doc) => {\n                docRef = docRef.collection(\"rounds\").doc();\n                batch.set(docRef, doc);\n              });\n              batch.commit().then(() => {\n                this.setState({hasCreatedGame: true});\n                socket.emit(\"getGroupSize\", this.state.code);\n              });\n            });\n          });\n          socket.on(\"groupSize\", (size) => {\n            this.setState({groupSize: size});\n            this.setState({hasReceivedGroupSize: true});\n          })\n        }\n\n        createGame() {\n          socket.emit(\"createGame\", this.state.code);\n        }\n\n      \n        render() {\n          return (\n            <div>\n              <label for=\"playersList\" id=\"label\">Players who have joined the room:</label>\n              <ul id=\"playersList\">\n                {this.state.players.map((idx, player) => {\n                  return <li key={idx}>{player}</li> })}\n              </ul>\n              <button type=\"button\" id=\"play\" onClick={this.createGame}>Play</button>\n              {this.state.hasCreatedGame && this.state.hasReceivedGroupSize ? <Redirect to={{pathname: '/game', state: {code: this.state.code, name: this.state.name, groupSize: this.state.groupSize, round: 1}}}/> : null }}\n            </div>\n          )\n        }\n      }\n\n  export default Room;"]},"metadata":{},"sourceType":"module"}