{"ast":null,"code":"import _toConsumableArray from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{Redirect}from'react-router-dom';import socket from\"../socketConfig\";import firebase from'../firebase.js';var Room=/*#__PURE__*/function(_React$Component){_inherits(Room,_React$Component);var _super=_createSuper(Room);function Room(props){var _this;_classCallCheck(this,Room);_this=_super.call(this,props);_this.createGame=function(){var db=firebase.firestore();db.collection(\"rooms\").where(\"code\",\"==\",_this.state.code).get().then(function(querySnapshot){querySnapshot.docs.forEach(function(snapshot){var docsArray=[];for(var i=0;i<snapshot.data().words.length;i++){docsArray.push({round:i+1,word:snapshot.data().words[i]});}var batch=db.batch();docsArray.forEach(function(doc){var docRef=snapshot.ref.collection(\"rounds\").doc();batch.set(docRef,doc);});batch.commit().then(function(){socket.emit(\"getGroupSize\",_this.state.code);});});});};_this.state={code:_this.props.location.state.code,name:_this.props.location.state.name,players:[],hasCreatedGame:false,groupSize:0,hasReceivedGroupSize:false};return _this;}_createClass(Room,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var db=firebase.firestore();db.collection(\"rooms\").where(\"code\",\"==\",this.state.code).get().then(function(querySnapshot){querySnapshot.docs.forEach(function(snapshot){snapshot.ref.collection(\"players\").onSnapshot(function(querySnapshot){querySnapshot.docs.forEach(function(snapshot){if(!_this2.state.players.includes(snapshot.data().name)){_this2.setState(function(prevState){return{players:[].concat(_toConsumableArray(prevState.players),[snapshot.data().name])};});}});});});});socket.on(\"groupSize\",function(size){_this2.setState({groupSize:size});_this2.setState({hasReceivedGroupSize:true});});}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"label\",{for:\"playersList\",id:\"label\"},\"Players who have joined the room:\"),/*#__PURE__*/React.createElement(\"ul\",{id:\"playersList\"},this.state.players.map(function(player,idx){return/*#__PURE__*/React.createElement(\"li\",{key:idx},player);})),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",id:\"play\",onClick:this.createGame},\"Play\"),this.state.hasCreatedGame&&this.state.hasReceivedGroupSize?/*#__PURE__*/React.createElement(Redirect,{to:{pathname:'/game',state:{code:this.state.code,name:this.state.name,groupSize:this.state.groupSize,round:1}}}):null);}}]);return Room;}(React.Component);export default Room;","map":{"version":3,"sources":["/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/src/pages/room.jsx"],"names":["React","Redirect","socket","firebase","Room","props","createGame","db","firestore","collection","where","state","code","get","then","querySnapshot","docs","forEach","snapshot","docsArray","i","data","words","length","push","round","word","batch","doc","docRef","ref","set","commit","emit","location","name","players","hasCreatedGame","groupSize","hasReceivedGroupSize","onSnapshot","includes","setState","prevState","on","size","map","player","idx","pathname","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { Redirect } from 'react-router-dom'\nimport socket from \"../socketConfig\";\nimport firebase from '../firebase.js';\n\nclass Room extends React.Component {\n\n        constructor(props) {\n          super(props);\n          this.state = {\n            code: this.props.location.state.code,\n            name: this.props.location.state.name,\n            players: [],\n            hasCreatedGame: false,\n            groupSize: 0,\n            hasReceivedGroupSize: false,\n          };\n        }\n      \n        componentDidMount() {\n          const db = firebase.firestore();\n          db.collection(\"rooms\").where(\"code\", \"==\", this.state.code).get().then((querySnapshot) => {\n            querySnapshot.docs.forEach((snapshot) => {\n              snapshot.ref.collection(\"players\").onSnapshot((querySnapshot) => {\n                querySnapshot.docs.forEach((snapshot) => {\n                  if (!this.state.players.includes(snapshot.data().name)) {\n                    this.setState(prevState => ({\n                      players: [...prevState.players, snapshot.data().name]\n                    }));\n                  }\n                });\n              });\n            });\n          });\n\n          socket.on(\"groupSize\", (size) => {\n            this.setState({groupSize: size});\n            this.setState({hasReceivedGroupSize: true});\n          });\n        }\n\n        createGame = () => {\n          const db = firebase.firestore();\n          db.collection(\"rooms\").where(\"code\", \"==\", this.state.code).get().then((querySnapshot) => {\n            querySnapshot.docs.forEach((snapshot) => {\n              const docsArray = [];\n              for (let i = 0; i < snapshot.data().words.length; i ++) {\n                docsArray.push({round: i + 1, word: snapshot.data().words[i]});\n              }\n              const batch = db.batch();\n              docsArray.forEach((doc) => {\n                let docRef = snapshot.ref.collection(\"rounds\").doc();\n                batch.set(docRef, doc);\n              });\n              batch.commit().then(() => {\n                socket.emit(\"getGroupSize\", this.state.code);\n              });\n            });\n          });\n        }\n\n      \n        render() {\n          return (\n            <div>\n              <label for=\"playersList\" id=\"label\">Players who have joined the room:</label>\n              <ul id=\"playersList\">\n                {this.state.players.map((player, idx) => {\n                  return <li key={idx}>{player}</li> })}\n              </ul>\n              <button type=\"button\" id=\"play\" onClick={this.createGame}>Play</button>\n              {this.state.hasCreatedGame && this.state.hasReceivedGroupSize ? <Redirect to={{pathname: '/game', state: {code: this.state.code, name: this.state.name, groupSize: this.state.groupSize, round: 1}}}/> : null }\n            </div>\n          )\n        }\n      }\n\n  export default Room;"]},"metadata":{},"sourceType":"module"}