{"ast":null,"code":"import _toConsumableArray from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{Redirect}from'react-router-dom';import socket from\"../socketConfig\";import firebase from'../firebase.js';var Room=/*#__PURE__*/function(_React$Component){_inherits(Room,_React$Component);var _super=_createSuper(Room);function Room(props){var _this;_classCallCheck(this,Room);_this=_super.call(this,props);_this.state={code:_this.props.location.state.code,name:_this.props.location.state.name,players:[],hasCreatedGame:false,groupSize:0,hasReceivedGroupSize:false};return _this;}_createClass(Room,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var db=firebase.firestore();db.collection(\"rooms\").where(\"code\",\"==\",this.state.code).get().then(function(querySnapshot){querySnapshot.docs.forEach(function(snapshot){snapshot.ref.collection(\"players\").get().then(function(querySnapshot){querySnapshot.docs.forEach(function(snapshot){_this2.setState(function(prevState){return{players:[].concat(_toConsumableArray(prevState.players),[snapshot.data().name])};});console.log(_this2.state.players);});});});});socket.on(\"groupSize\",function(size){_this2.setState({groupSize:size});_this2.setState({hasReceivedGroupSize:true});});}},{key:\"createGame\",value:function createGame(){var _this3=this;var db=firebase.firestore();db.collection(\"rooms\").where(\"code\",\"==\",this.state.code).get().then(function(querySnapshot){querySnapshot.docs.forEach(function(snapshot){var docsArray=[];for(var i=0;i<snapshot.data().words.length;i++){docsArray.push({round:i+1,word:snapshot.data().words[i]});}var batch=db.batch();docsArray.forEach(function(doc){var docRef=snapshot.ref.collection(\"rounds\").doc();batch.set(docRef,doc);});batch.commit().then(function(){_this3.setState({hasCreatedGame:true});socket.emit(\"getGroupSize\",_this3.state.code);});});});}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"label\",{for:\"playersList\",id:\"label\"},\"Players who have joined the room:\"),/*#__PURE__*/React.createElement(\"ul\",{id:\"playersList\"},this.state.players.map(function(idx,player){console.log(idx);return/*#__PURE__*/React.createElement(\"li\",{key:idx},player);})),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",id:\"play\",onClick:this.createGame},\"Play\"),this.state.hasCreatedGame&&this.state.hasReceivedGroupSize?/*#__PURE__*/React.createElement(Redirect,{to:{pathname:'/game',state:{code:this.state.code,name:this.state.name,groupSize:this.state.groupSize,round:1}}}):null,\"}\");}}]);return Room;}(React.Component);export default Room;","map":{"version":3,"sources":["/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/src/pages/room.jsx"],"names":["React","Redirect","socket","firebase","Room","props","state","code","location","name","players","hasCreatedGame","groupSize","hasReceivedGroupSize","db","firestore","collection","where","get","then","querySnapshot","docs","forEach","snapshot","ref","setState","prevState","data","console","log","on","size","docsArray","i","words","length","push","round","word","batch","doc","docRef","set","commit","emit","map","idx","player","createGame","pathname","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { Redirect } from 'react-router-dom'\nimport socket from \"../socketConfig\";\nimport firebase from '../firebase.js';\n\nclass Room extends React.Component {\n\n        constructor(props) {\n          super(props);\n          this.state = {\n            code: this.props.location.state.code,\n            name: this.props.location.state.name,\n            players: [],\n            hasCreatedGame: false,\n            groupSize: 0,\n            hasReceivedGroupSize: false,\n          };\n        }\n      \n        componentDidMount() {\n          const db = firebase.firestore();\n          db.collection(\"rooms\").where(\"code\", \"==\", this.state.code).get().then((querySnapshot) => {\n            querySnapshot.docs.forEach((snapshot) => {\n              snapshot.ref.collection(\"players\").get().then((querySnapshot) => {\n                querySnapshot.docs.forEach((snapshot) => {\n                  this.setState(prevState => ({\n                    players: [...prevState.players, snapshot.data().name]\n                  }));\n                  console.log(this.state.players);\n                });\n              });\n            });\n          });\n          socket.on(\"groupSize\", (size) => {\n            this.setState({groupSize: size});\n            this.setState({hasReceivedGroupSize: true});\n          });\n        }\n\n        createGame() {\n          const db = firebase.firestore();\n          db.collection(\"rooms\").where(\"code\", \"==\", this.state.code).get().then((querySnapshot) => {\n            querySnapshot.docs.forEach((snapshot) => {\n              const docsArray = [];\n              for (let i = 0; i < snapshot.data().words.length; i ++) {\n                docsArray.push({round: i + 1, word: snapshot.data().words[i]});\n              }\n              const batch = db.batch();\n              docsArray.forEach((doc) => {\n                let docRef = snapshot.ref.collection(\"rounds\").doc();\n                batch.set(docRef, doc);\n              });\n              batch.commit().then(() => {\n                this.setState({hasCreatedGame: true});\n                socket.emit(\"getGroupSize\", this.state.code);\n              });\n            });\n          });\n        }\n\n      \n        render() {\n          return (\n            <div>\n              <label for=\"playersList\" id=\"label\">Players who have joined the room:</label>\n              <ul id=\"playersList\">\n                {this.state.players.map((idx, player) => {\n                  console.log(idx);\n                  return <li key={idx}>{player}</li> })}\n              </ul>\n              <button type=\"button\" id=\"play\" onClick={this.createGame}>Play</button>\n              {this.state.hasCreatedGame && this.state.hasReceivedGroupSize ? <Redirect to={{pathname: '/game', state: {code: this.state.code, name: this.state.name, groupSize: this.state.groupSize, round: 1}}}/> : null }}\n            </div>\n          )\n        }\n      }\n\n  export default Room;"]},"metadata":{},"sourceType":"module"}