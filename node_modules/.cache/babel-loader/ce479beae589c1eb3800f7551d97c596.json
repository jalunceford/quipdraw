{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef,useEffect,useState}from'react';import{Redirect}from'react-router-dom';import socket from\"../socketConfig\";import firebase from'../firebase.js';import'./styles.css';function Game(props){var canvasRef=useRef(null);var contextRef=useRef(null);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isDrawing=_useState2[0],setIsDrawing=_useState2[1];var _useState3=useState(20),_useState4=_slicedToArray(_useState3,2),time=_useState4[0],setTime=_useState4[1];var _useState5=useState(props.location.state.code),_useState6=_slicedToArray(_useState5,2),code=_useState6[0],setCode=_useState6[1];var _useState7=useState(props.location.state.name),_useState8=_slicedToArray(_useState7,2),name=_useState8[0],setName=_useState8[1];var _useState9=useState(props.location.state.round),_useState10=_slicedToArray(_useState9,2),round=_useState10[0],setRound=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),voteTime=_useState12[0],setVoteTime=_useState12[1];var _useState13=useState(props.location.state.groupSize),_useState14=_slicedToArray(_useState13,2),groupSize=_useState14[0],setGroupSize=_useState14[1];var _useState15=useState(),_useState16=_slicedToArray(_useState15,2),word=_useState16[0],setWord=_useState16[1];useEffect(function(){console.log(groupSize);var pictures=0;socket.on('picture',function(){console.log(\"picture came in\");pictures++;if(pictures==groupSize){setVoteTime(true);}});var canvas=canvasRef.current;canvas.width=window.innerWidth*2;canvas.height=window.innerHeight*2;canvas.style.width=\"\".concat(window.innerWidth,\"px\");canvas.style.height=\"\".concat(window.innerHeight,\"px\");var context=canvas.getContext(\"2d\");context.scale(2,2);context.lineCap=\"round\";context.strokeStyle=\"black\";context.lineWidth=5;contextRef.current=context;var myAsyncFunc=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var time2,interval;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getWord();case 2:time2=20;interval=setInterval(function(){setTime(function(time){return time-1;});time2=time2-1;if(time2==0){clearInterval(interval);var dataURL=canvasRef.current.toDataURL();var db=firebase.firestore();db.collection(\"rooms\").where(\"code\",\"==\",code).get().then(function(querySnapshot){querySnapshot.docs.forEach(function(snapshot){snapshot.ref.collection(\"rounds\").where(\"round\",\"==\",round).get().then(function(querySnapshot){querySnapshot.docs.forEach(function(snapshot){snapshot.ref.collection(\"pictures\").add({artist:name,dataURL:dataURL,votes:0}).then(function(){socket.emit(\"picture\",code);});});});});});}},1000);case 4:case\"end\":return _context.stop();}}},_callee);}));return function myAsyncFunc(){return _ref.apply(this,arguments);};}();myAsyncFunc();},[]);var getWord=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var db;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:db=firebase.firestore();db.collection(\"rooms\").where(\"code\",\"==\",code).get().then(function(querySnapshot){querySnapshot.docs.forEach(function(snapshot){snapshot.ref.collection(\"rounds\").where(\"round\",\"==\",round).get().then(function(querySnapshot){querySnapshot.docs.forEach(function(snapshot){setWord(snapshot.data().word);});});});});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function getWord(){return _ref2.apply(this,arguments);};}();var startDrawing=function startDrawing(_ref3){var nativeEvent=_ref3.nativeEvent;var offsetX=nativeEvent.offsetX,offsetY=nativeEvent.offsetY;contextRef.current.beginPath();contextRef.current.moveTo(offsetX,offsetY);setIsDrawing(true);};var finishDrawing=function finishDrawing(){contextRef.current.closePath();setIsDrawing(false);};var draw=function draw(_ref4){var nativeEvent=_ref4.nativeEvent;if(!isDrawing){return;}var offsetX=nativeEvent.offsetX,offsetY=nativeEvent.offsetY;contextRef.current.lineTo(offsetX,offsetY);contextRef.current.stroke();};var clearCanvas=function clearCanvas(){contextRef.current.clearRect(0,0,canvasRef.current.width,canvasRef.current.height);};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h1\",{className:\"headers\"},time),/*#__PURE__*/React.createElement(\"h1\",{className:\"headers\"},word),/*#__PURE__*/React.createElement(\"button\",{onClick:clearCanvas},\"Clear\"),/*#__PURE__*/React.createElement(\"canvas\",{onMouseDown:startDrawing,onMouseUp:finishDrawing,onMouseMove:draw,ref:canvasRef}),voteTime?/*#__PURE__*/React.createElement(Redirect,{to:{pathname:'/vote',state:{code:code,name:name,round:round,groupSize:groupSize}}}):null);}export default Game;","map":{"version":3,"sources":["/Users/jacklunceford/Desktop/quiplash_drawing_game/react-app/src/pages/game.jsx"],"names":["React","useRef","useEffect","useState","Redirect","socket","firebase","Game","props","canvasRef","contextRef","isDrawing","setIsDrawing","time","setTime","location","state","code","setCode","name","setName","round","setRound","voteTime","setVoteTime","groupSize","setGroupSize","word","setWord","console","log","pictures","on","canvas","current","width","window","innerWidth","height","innerHeight","style","context","getContext","scale","lineCap","strokeStyle","lineWidth","myAsyncFunc","getWord","time2","interval","setInterval","clearInterval","dataURL","toDataURL","db","firestore","collection","where","get","then","querySnapshot","docs","forEach","snapshot","ref","add","artist","votes","emit","data","startDrawing","nativeEvent","offsetX","offsetY","beginPath","moveTo","finishDrawing","closePath","draw","lineTo","stroke","clearCanvas","clearRect","pathname"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\nimport { Redirect } from 'react-router-dom';\nimport socket from \"../socketConfig\";\nimport firebase from '../firebase.js';\nimport './styles.css';\n\nfunction Game(props) {\n\n  const canvasRef = useRef(null)\n  const contextRef = useRef(null)\n  const [isDrawing, setIsDrawing] = useState(false)\n  const [time, setTime] = useState(20);\n  const [code, setCode] = useState(props.location.state.code);\n  const [name, setName] = useState(props.location.state.name);\n  const [round, setRound] = useState(props.location.state.round);\n  const [voteTime, setVoteTime] = useState(false);\n  const [groupSize, setGroupSize] = useState(props.location.state.groupSize);\n  const [word, setWord] = useState();\n\n  useEffect(() => {\n    console.log(groupSize);\n    let pictures = 0;\n    socket.on('picture', () => {\n      console.log(\"picture came in\");\n      pictures ++;\n      if (pictures == groupSize) {\n        setVoteTime(true);\n      }\n    });\n    const canvas = canvasRef.current;\n    canvas.width = window.innerWidth * 2;\n    canvas.height = window.innerHeight * 2;\n    canvas.style.width = `${window.innerWidth}px`;\n    canvas.style.height = `${window.innerHeight}px`;\n\n    const context = canvas.getContext(\"2d\")\n    context.scale(2,2)\n    context.lineCap = \"round\"\n    context.strokeStyle = \"black\"\n    context.lineWidth = 5\n    contextRef.current = context;\n    const myAsyncFunc = async() =>{\n      await getWord();\n      let time2 = 20;\n      const interval = setInterval(() =>{\n        setTime(time => time - 1);\n        time2 = time2 - 1;\n        if (time2 == 0) {\n          clearInterval(interval);\n          let dataURL = canvasRef.current.toDataURL();\n          const db = firebase.firestore();\n          db.collection(\"rooms\").where(\"code\", \"==\", code).get().then((querySnapshot) => {\n            querySnapshot.docs.forEach((snapshot) => {\n              snapshot.ref.collection(\"rounds\").where(\"round\", \"==\", round).get().then((querySnapshot) => {\n                querySnapshot.docs.forEach((snapshot) => {\n                  snapshot.ref.collection(\"pictures\").add({artist: name, dataURL: dataURL, votes: 0}).then(() => {\n                    socket.emit(\"picture\", code);\n                  });\n                });\n              });\n            });\n          });\n        }\n    }, 1000);\n  }\n  myAsyncFunc();\n  }, []);\n\n  const getWord = async() => {\n    const db = firebase.firestore();\n    db.collection(\"rooms\").where(\"code\", \"==\", code).get().then((querySnapshot) => {\n      querySnapshot.docs.forEach((snapshot) => {\n        snapshot.ref.collection(\"rounds\").where(\"round\", \"==\", round).get().then((querySnapshot) => {\n          querySnapshot.docs.forEach((snapshot) => {\n              setWord(snapshot.data().word);\n          });\n      });\n  });\n});\n}\n\n  const startDrawing = ({nativeEvent}) => {\n    const {offsetX, offsetY} = nativeEvent;\n    contextRef.current.beginPath()\n    contextRef.current.moveTo(offsetX, offsetY)\n    setIsDrawing(true)\n  }\n\n  const finishDrawing = () => {\n   contextRef.current.closePath()\n   setIsDrawing(false)\n  }\n\n  const draw = ({nativeEvent}) => {\n    if(!isDrawing){\n      return\n    }\n    const {offsetX, offsetY} = nativeEvent;\n    contextRef.current.lineTo(offsetX, offsetY)\n    contextRef.current.stroke()\n  }\n\n  const clearCanvas = () => {\n    contextRef.current.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\n  }\n\n  return (\n    <div>\n        <h1 className=\"headers\">{time}</h1>\n        <h1 className=\"headers\">{word}</h1>\n        <button onClick={clearCanvas}>Clear</button>\n        <canvas\n        onMouseDown={startDrawing}\n        onMouseUp={finishDrawing}\n        onMouseMove={draw}\n        ref={canvasRef}\n        />\n        {voteTime ? <Redirect to={{pathname: '/vote', state: {code: code, name: name, round: round, groupSize: groupSize}}}/> : null }\n    </div>\n    );\n}\n\nexport default Game;"]},"metadata":{},"sourceType":"module"}